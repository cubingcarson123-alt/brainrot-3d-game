<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Brainrot Horror Maze</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body{margin:0;overflow:hidden;background:black}
#ui{
 position:fixed;
 top:10px;left:10px;
 font-family:monospace;
 color:white;
}
#meter{width:200px;height:14px;background:#333;margin-top:6px}
#fill{height:100%;width:0%;background:lime}
</style>
</head>
<body>
<div id="ui">
Brainrot Nearby
<div id="meter"><div id="fill"></div></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script>
/* ===== SCENE ===== */
const scene=new THREE.Scene();
scene.background=new THREE.Color(0x050505);
const camera=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);
const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

addEventListener("resize",()=>{
 camera.aspect=innerWidth/innerHeight;
 camera.updateProjectionMatrix();
 renderer.setSize(innerWidth,innerHeight);
});

scene.add(new THREE.AmbientLight(0xffffff,0.6));

/* ===== MAZE ===== */
const GRID=21, CELL=10;
const maze=Array.from({length:GRID},()=>Array(GRID).fill(1));

function carve(x,y){
 maze[y][x]=0;
 [[2,0],[-2,0],[0,2],[0,-2]].sort(()=>Math.random()-0.5)
 .forEach(([dx,dy])=>{
  const nx=x+dx, ny=y+dy;
  if(nx>0&&ny>0&&nx<GRID-1&&ny<GRID-1&&maze[ny][nx]){
   maze[y+dy/2][x+dx/2]=0;
   carve(nx,ny);
  }
 });
}
carve(1,1);

/* ===== WALLS ===== */
const wallGeo=new THREE.BoxGeometry(CELL,5,CELL);
const wallMat=new THREE.MeshStandardMaterial({color:0x444444});
for(let z=0;z<GRID;z++){
 for(let x=0;x<GRID;x++){
  if(maze[z][x]){
   const w=new THREE.Mesh(wallGeo,wallMat);
   w.position.set((x-GRID/2)*CELL,2.5,(z-GRID/2)*CELL);
   scene.add(w);
  }
 }
}

/* ===== FLOOR ===== */
const floor=new THREE.Mesh(
 new THREE.PlaneGeometry(1000,1000),
 new THREE.MeshStandardMaterial({color:0x111111})
);
floor.rotation.x=-Math.PI/2;
scene.add(floor);

/* ===== HELPERS ===== */
const worldFromGrid=v=>(v-GRID/2)*CELL;
const open=(x,z)=>maze[z]?.[x]===0;

function randomCell(){
 while(true){
  const x=Math.floor(Math.random()*GRID);
  const z=Math.floor(Math.random()*GRID);
  if(open(x,z)) return {x,z};
 }
}

/* ===== PLAYER ===== */
let player=randomCell();
let yaw=0;

/* ===== ENEMY ===== */
let enemy=randomCell();
const enemyMesh=new THREE.Mesh(
 new THREE.BoxGeometry(2,2,2),
 new THREE.MeshStandardMaterial({color:0xff3333})
);
scene.add(enemyMesh);

/* ===== A* ===== */
function findPath(sx,sz,tx,tz){
 const q=[[sx,sz]];
 const came={}, seen=new Set([sx+","+sz]);
 while(q.length){
  const [x,z]=q.shift();
  if(x===tx&&z===tz) break;
  [[1,0],[-1,0],[0,1],[0,-1]].forEach(([dx,dz])=>{
   const nx=x+dx,nz=z+dz;
   const k=nx+","+nz;
   if(open(nx,nz)&&!seen.has(k)){
    seen.add(k);
    came[k]=[x,z];
    q.push([nx,nz]);
   }
  });
 }
 let path=[[tx,tz]];
 while(came[path[0][0]+","+path[0][1]])
  path.unshift(came[path[0][0]+","+path[0][1]]);
 return path;
}

let path=[],step=0,tick=0;

/* ===== INPUT ===== */
let forward=false;
addEventListener("keydown",e=>{if(e.key==="w")forward=true});
addEventListener("keyup",e=>{if(e.key==="w")forward=false});

addEventListener("mousemove",e=>{
 if(document.pointerLockElement===document.body)
  yaw-=e.movementX*0.002;
});
document.body.onclick=()=>document.body.requestPointerLock();

/* ===== LOOP ===== */
const fill=document.getElementById("fill");

function animate(){
 requestAnimationFrame(animate);

 if(forward){
  const nx=player.x-Math.round(Math.sin(yaw));
  const nz=player.z-Math.round(Math.cos(yaw));
  if(open(nx,nz)) player={x:nx,z:nz};
 }

 tick++;
 if(tick%20===0){
  path=findPath(enemy.x,enemy.z,player.x,player.z);
  step=1;
 }

 if(path[step]){
  enemy=path[step];
  step++;
 }

 enemyMesh.position.set(worldFromGrid(enemy.x),1,worldFromGrid(enemy.z));

 const dx=player.x-enemy.x, dz=player.z-enemy.z;
 const dist=Math.hypot(dx,dz);
 const danger=Math.max(0,1-dist/8);
 fill.style.width=(danger*100)+"%";
 fill.style.background=danger>0.7?"red":danger>0.4?"orange":"lime";

 camera.position.set(worldFromGrid(player.x),1.7,worldFromGrid(player.z));
 camera.rotation.set(0,yaw,0);

 renderer.render(scene,camera);
}
animate();
</script>
</body>
</html>
