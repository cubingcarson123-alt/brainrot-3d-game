<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Brainrot Maze FIXED</title>
<style>
html,body{margin:0;overflow:hidden;background:black;color:white}
#ui{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:black;z-index:9}
button{font-size:22px;padding:12px 30px}
#meter{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);width:300px;height:16px;border:2px solid white}
#fill{height:100%;width:0%;background:red}
canvas{display:block}
</style>
</head>
<body>

<div id="ui">
  <button id="start">CLICK TO START</button>
</div>

<div id="meter"><div id="fill"></div></div>
<canvas id="c"></canvas>

<script>
const c = document.getElementById("c");
const ctx = c.getContext("2d");
c.width = innerWidth;
c.height = innerHeight;
addEventListener("resize",()=>{c.width=innerWidth;c.height=innerHeight});

/* MAZE */
const CELL=140,W=14,H=14;
const maze=[...Array(H)].map(()=>[...Array(W)].map(()=>Math.random()<0.35?1:0));
maze[1][1]=0;

/* PLAYER */
const p={x:CELL*1.5,y:CELL*1.5,a:0,s:2.8};

/* BRAINROT */
const b={x:CELL*(W-2),y:CELL*(H-2),s:1.3};

let lock=false,forward=false;

/* INPUT */
c.onclick=()=>c.requestPointerLock();
document.addEventListener("pointerlockchange",()=>lock=document.pointerLockElement===c);
document.addEventListener("mousemove",e=>{if(lock)p.a+=e.movementX*0.002});
document.addEventListener("keydown",e=>{if(e.key==="w")forward=true});
document.addEventListener("keyup",e=>{if(e.key==="w")forward=false});

/* COLLISION */
function wall(x,y){
  const mx=Math.floor(x/CELL),my=Math.floor(y/CELL);
  return maze[my]?.[mx]===1;
}
function move(o,dx,dy){
  if(!wall(o.x+dx,o.y))o.x+=dx;
  if(!wall(o.x,o.y+dy))o.y+=dy;
}

/* LOOP */
function update(){
  if(lock&&forward){
    const dx=Math.cos(p.a)*p.s;
    const dy=Math.sin(p.a)*p.s;
    move(p,dx,dy);
  }

  const dx=p.x-b.x,dy=p.y-b.y;
  const d=Math.hypot(dx,dy)||1;
  move(b,dx/d*b.s,dy/d*b.s);

  document.getElementById("fill").style.width=`${Math.max(0,1-d/600)*100}%`;
}

function draw(){
  ctx.fillStyle="#000";
  ctx.fillRect(0,0,c.width,c.height);

  ctx.save();
  ctx.translate(c.width/2,c.height/2);
  ctx.rotate(p.a);           // ðŸ”¥ FIXED
  ctx.translate(-p.x,-p.y);

  ctx.fillStyle="#111";
  ctx.fillRect(0,0,W*CELL,H*CELL);

  ctx.fillStyle="#333";
  for(let y=0;y<H;y++)for(let x=0;x<W;x++)
    if(maze[y][x])ctx.fillRect(x*CELL,y*CELL,CELL,CELL);

  ctx.fillStyle="red";
  ctx.fillRect(b.x-20,b.y-20,40,40);

  ctx.restore();

  ctx.strokeStyle="white";
  ctx.beginPath();
  ctx.moveTo(c.width/2-6,c.height/2);
  ctx.lineTo(c.width/2+6,c.height/2);
  ctx.stroke();
}

(function loop(){
  update(); draw();
  requestAnimationFrame(loop);
})();

document.getElementById("start").onclick=()=>document.getElementById("ui").remove();
</script>
</body>
</html>
